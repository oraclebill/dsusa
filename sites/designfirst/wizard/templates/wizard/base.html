{% extends "base.html" %}
{% load ajax_form_utils %}


{% block title %}{{wizard.order}} | {{wizard.step_title}}{% endblock %}




{% block extra-head %}
<style>
#summary_content {
  height: 500px;
  margin-right: -10px;
  padding-right: 10px;
  overflow: auto;
}

#summary_content fieldset {
}

#summary_content fieldset legend {
  background: inherit;
  border: none;
  font-weight: bolder;
}

#summary_content dl {
  margin-bottom: 0;
}

#summary_content dt {
  display: run-in;
  font-weight: bolder;
  padding: .25em .5em;
  background: #cccccc;
}

#summary_content dd {
  padding-top: .25em;
  padding-left: 2em;
  margin-bottom: 1em;
}

</style>

	{{form.media}}
	<script type="text/javascript" src="{{ MEDIA_URL }}js/jquery.ajax_forms.js"></script>
	<script type="text/javascript" src="{{ MEDIA_URL }}js/jquery.ajax_forms.validation.js"></script>
<script>
var STEP = '{{wizard.step}}'
var MEDIA_URL = '{{ MEDIA_URL }}'
var IS_FIRST_STEP = {{wizard.is_first_step|lower}};
var KEY_TAB = 9;

function wizard_go_to(step) {
	$('#next_step').val(step)
	$('form#wizard_form').submit();
}

{% block ajax-validation %}
$(function(){
	//Ajax validation:
	$('form').validation({% render_ajax_fields form %});
})
{% endblock %}

function get_fieldset_id(element) {
	var id = false;
	$(element).parents().each(function(){
		if (this.tagName == 'FIELDSET') {
			id = $(this).attr('id').replace('fields_', '')
			return false
		}
	})
	return id;
}

$(function(){
	//Tabs navigation:	
	$('#wizard_content :input:visible:first').keydown(function(event){
		if (event.keyCode == KEY_TAB && event.shiftKey) {
			if (!IS_FIRST_STEP)
				wizard_go_to('_prev_')
			return false;
		}
	}).focus()
	$('#wizard_content :input:visible:last').keydown(function(event){
		if (event.keyCode == KEY_TAB && !event.shiftKey) {
			wizard_go_to('_next_')
			return false;
		}
	})
	$('#wizard_steps a').click(function(){
		wizard_go_to($(this).attr('step'))
		return false;
	})

	//Collapse fieldsets:
	$('fieldset.collapse legend').click(function() {
		$(this).parent().find('div').toggle('fast');
	})
})
</script>
{% endblock %}


{% block content %}
</div> <!-- end container -->
<div class="container_16">
<div id="wizard_steps" class="grid_16">
{% block wizard-steps%}
	{% for step in wizard.get_tabs %}
		<div{% if step.selected %} class="selected"{% endif %}>
			<a href="{{ step.url }}" step="{{step.slug}}"><img src="{{MEDIA_URL}}images/wizard/{{step.slug}}{% if step.selected %}_selected{% endif %}.png"></a>
			<br>
			{{step.title}}
		</div>
	{% endfor %}
{% endblock %}
<div class="clear"></div>
</div>



</div> <!-- end container -->
<div class="container_16 clearfix">

{% block wizard-base-content %}
<div id="wizard_content" class="grid_11 ">
<form method="POST"{% if form.is_multipart %} enctype="multipart/form-data"{% endif %} id="wizard_form">
<input type="hidden" name="next_step_" id="next_step" value="_next_">
<fieldset>
	<legend>{{wizard.step_title}}</legend>
	{% block wizard-content %}
	{% endblock %}
</fieldset>
</form>
</div>


<div id="wizard_summary"  class="grid_5 ">
<fieldset>
	<legend>Order summary</legend>
	{% block wizard-summary%}
	Project Name: <strong>{{wizard.order}}</strong>
	
	<div id="summary_content">
	{% for section, values in wizard.get_summary %}
	<fieldset>
		<legend>{{section}}</legend>
		<dl>
		{% for name, value in values %}
		    <dt>{{name}}</dt><dd>{{value|default:"Not Specified"}}</dd>
		{% endfor %}
		</dl>
	</fieldset>
	{% endfor %}
	</div>	
	{% endblock %}
</fieldset>
</div>


{% endblock wizard-base-content %}

</div> <!-- end container -->
<div class="container_16">

<div class="grid_2" style="text-align: center;">

<!-- <input type="submit" name="{{BTN_SKIP}}" value="Skip"> -->
<a href="/dealer/">Back to dashboard</a>
</div>
<div class="grid_3 prefix_11">
<form method="POST" id="wizard_nav_form">
<input type="submit" name="{{BTN_PREVIOUS}}" value="Previous"{% if wizard.is_first_step %} disabled="disabled"{%endif%}>
<input type="submit" name="{{BTN_SAVENEXT}}" value="Save/Next">
</form>
</div>

<div class="clear"></div>




{% endblock %}
